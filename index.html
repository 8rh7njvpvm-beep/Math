<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŠ€æ²³æ¼¢å ¡åº—ï¼šåˆ—æ–¹ç¨‹å¤§æŒ‘æˆ°</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-pink: #ff00ff;
            --neon-green: #00ff41;
            --bg-dark: #0a0a12;
            --panel-bg: rgba(20, 20, 40, 0.9);
        }

        body {
            background-color: var(--bg-dark);
            background-image: 
                radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 3px),
                radial-gradient(white, rgba(255,255,255,.15) 1px, transparent 2px),
                radial-gradient(white, rgba(255,255,255,.1) 2px, transparent 3px);
            background-size: 550px 550px, 350px 350px, 250px 250px;
            background-position: 0 0, 40px 60px, 130px 270px;
            font-family: 'Noto Sans TC', sans-serif;
            color: white;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none;
        }

        #game-interface {
            width: 90%;
            max-width: 600px;
            background: var(--panel-bg);
            border: 2px solid var(--neon-blue);
            box-shadow: 0 0 20px var(--neon-blue), inset 0 0 20px rgba(0, 243, 255, 0.2);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        /* æŠ¬é ­é¡¯ç¤ºå™¨ */
        .hud {
            display: flex;
            justify-content: space-between;
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: var(--neon-green);
            text-shadow: 0 0 5px var(--neon-green);
        }

        /* å¤–æ˜Ÿé¡§å®¢å€ */
        .customer-area {
            height: 180px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            position: relative;
        }

        .alien {
            font-size: 5rem;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px var(--neon-pink));
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .speech-bubble {
            background: white;
            color: #000;
            padding: 15px;
            border-radius: 15px;
            position: relative;
            max-width: 80%;
            font-weight: bold;
            box-shadow: 0 0 10px white;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 10px 10px 0;
            border-style: solid;
            border-color: white transparent;
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0); }
            to { opacity: 1; transform: scale(1); }
        }

        /* å»šæˆ¿æ§åˆ¶å° (é¸é …) */
        .kitchen-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .btn-recipe {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--neon-pink);
            color: var(--neon-pink);
            padding: 20px;
            font-size: 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            transition: all 0.2s;
            text-shadow: 0 0 5px var(--neon-pink);
            box-shadow: 0 0 10px rgba(255, 0, 255, 0.2);
        }

        .btn-recipe:hover {
            background: var(--neon-pink);
            color: #000;
            box-shadow: 0 0 20px var(--neon-pink);
            transform: translateY(-2px);
        }

        .btn-recipe:active {
            transform: translateY(2px);
        }

        /* è¦†è“‹å±¤ */
        .overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 10, 18, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            border-radius: 18px;
        }

        .btn-start {
            background: var(--neon-green);
            color: #000;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            font-family: 'Orbitron', sans-serif;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 20px var(--neon-green);
            border-radius: 5px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 20px var(--neon-green); }
            50% { box-shadow: 0 0 40px var(--neon-green); }
            100% { box-shadow: 0 0 20px var(--neon-green); }
        }

        /* æ¼¢å ¡å‹•ç•« */
        .burger-anim {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8rem;
            opacity: 0;
            pointer-events: none;
            z-index: 50;
            transition: all 0.5s;
        }

        /* éœéŸ³æŒ‰éˆ• */
        #mute-btn {
            position: absolute; top: 10px; right: 10px;
            background: none; border: 1px solid var(--neon-blue);
            color: var(--neon-blue); padding: 5px 10px;
            cursor: pointer; font-size: 0.8rem; z-index: 200;
        }

    </style>
</head>
<body>

    <div id="game-interface">
        <button id="mute-btn" onclick="toggleMute()">ğŸ”Š éŸ³æ•ˆé–‹</button>

        <div class="hud">
            <span>SCORE: <span id="score">0</span></span>
            <span>LEVEL: <span id="level">1</span></span>
        </div>

        <div class="customer-area">
            <div class="speech-bubble" id="order-text">
                è¨‚å–®è¼‰å…¥ä¸­...
            </div>
            <div class="alien" id="alien-avatar">ğŸ‘½</div>
        </div>

        <h3 style="color:var(--neon-blue); margin: 10px 0;">è«‹é¸æ“‡æ­£ç¢ºçš„é…æ–¹ (æ–¹ç¨‹)ï¼š</h3>

        <div class="kitchen-controls" id="options-container">
            </div>

        <div id="feedback" class="burger-anim">ğŸ”</div>

        <div id="start-screen" class="overlay">
            <h1 style="color:var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue);">GALAXY BURGER</h1>
            <p style="margin-bottom: 30px; color: #ccc;">å¤–æ˜Ÿäººè‚šå­é¤“äº†ï¼<br>è«‹æ ¹æ“šä»–å€‘çš„æè¿°åˆ—å‡ºæ­£ç¢ºæ–¹ç¨‹ã€‚</p>
            <button class="btn-start" onclick="startGame()">é–‹å§‹ç‡Ÿæ¥­</button>
        </div>

        <div id="end-screen" class="overlay" style="display: none;">
            <h2 style="color:var(--neon-pink);">æ‰“çƒŠäº†ï¼</h2>
            <p id="final-score" style="font-size: 1.5rem; margin-bottom: 20px;">ç‡Ÿæ”¶: $0</p>
            <button class="btn-start" onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        // --- éŸ³æ•ˆç³»çµ± (Web Audio API) ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;
        let isMuted = false;
        let bgmInterval;
        let bgmNoteIndex = 0;

        function initAudio() {
            if (!audioCtx) audioCtx = new AudioContext();
            if (audioCtx.state === 'suspended') audioCtx.resume();
            startBGM();
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('mute-btn').innerText = isMuted ? "ğŸ”‡ éŸ³æ•ˆé—œ" : "ğŸ”Š éŸ³æ•ˆé–‹";
            if(isMuted && audioCtx) audioCtx.suspend();
            else if(audioCtx) audioCtx.resume();
        }

        function playTone(freq, type, duration, startTime=0, vol=0.1) {
            if (!audioCtx || isMuted) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime + startTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime + startTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + startTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(audioCtx.currentTime + startTime);
            osc.stop(audioCtx.currentTime + startTime + duration);
        }

        // BGM: å¤ªç©ºè¼•éŸ³æ¨‚
        function startBGM() {
            if (bgmInterval) clearInterval(bgmInterval);
            const melody = [
                392, 0, 440, 0, 329, 0, 261, 0, // G A E C
                196, 0, 261, 0, 329, 392, 0, 0  // G C E G
            ];
            bgmInterval = setInterval(() => {
                if(!isMuted) {
                    let freq = melody[bgmNoteIndex];
                    if(freq > 0) playTone(freq, 'sine', 0.3, 0, 0.05);
                }
                bgmNoteIndex = (bgmNoteIndex + 1) % melody.length;
            }, 250);
        }

        // SFX: ç…è‚‰æ»‹æ»‹è² (ç™½å™ªéŸ³)
        function playSizzle() {
            if (!audioCtx || isMuted) return;
            const bufferSize = audioCtx.sampleRate * 0.5;
            const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < bufferSize; i++) {
                data[i] = Math.random() * 2 - 1;
            }
            const noise = audioCtx.createBufferSource();
            noise.buffer = buffer;
            const gain = audioCtx.createGain();
            gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            noise.connect(gain);
            gain.connect(audioCtx.destination);
            noise.start();
            
            // åŠ ä¸Šå®ä¸€è²
            playTone(880, 'triangle', 0.5, 0.1, 0.1); 
        }

        // SFX: å¤–æ˜Ÿäººæ€’å¼ (ä½é »é‹¸é½’æ³¢)
        function playAlienGrunt() {
            playTone(150, 'sawtooth', 0.2, 0, 0.2);
            playTone(100, 'sawtooth', 0.4, 0.1, 0.2);
        }

        // --- éŠæˆ²é‚è¼¯ ---
        
        // é¡Œåº«ï¼šå¼·èª¿ã€Œåˆ—å¼ã€çš„é‚è¼¯
        // x ä»£è¡¨æœªçŸ¥çš„æ•¸é‡
        const questions = [
            {
                text: "æˆ‘çš„æ¼¢å ¡åŸæœ¬æœ‰ x å…‹ï¼Œåƒäº† 50 å…‹å¾Œï¼Œå‰©ä¸‹ 150 å…‹ã€‚",
                correct: "x - 50 = 150",
                options: ["x - 50 = 150", "x + 50 = 150", "x = 150 - 50", "50x = 150"]
            },
            {
                text: "ä¸€ä»½å¥—é¤è³£ x å…ƒï¼Œè²·äº† 4 ä»½ï¼Œç¸½å…±ä»˜äº† 200 å…ƒã€‚",
                correct: "4x = 200",
                options: ["4x = 200", "x + 4 = 200", "x Ã· 4 = 200", "x - 4 = 200"]
            },
            {
                text: "æˆ‘æœ‰ x å¡Šèƒ½é‡çŸ³ï¼Œåˆ†çµ¦ 3 å€‹å¤–æ˜Ÿäººï¼Œæ¯äººæ‹¿åˆ° 6 å¡Šã€‚",
                correct: "x Ã· 3 = 6",
                options: ["x Ã· 3 = 6", "3x = 6", "x - 3 = 6", "x + 3 = 6"]
            },
            {
                text: "å€‰åº«æœ‰ x æ¡¶ç‡ƒæ–™ï¼Œé€™é€±é€²è²¨ 10 æ¡¶ï¼Œç¾åœ¨å…±æœ‰ 50 æ¡¶ã€‚",
                correct: "x + 10 = 50",
                options: ["x + 10 = 50", "x - 10 = 50", "10x = 50", "x = 50 + 10"]
            },
            {
                text: "å¤ªç©ºèˆ¹é€Ÿåº¦æ˜¯ xï¼ŒåŠ é€Ÿ 2 å€å¾Œï¼Œé€Ÿåº¦è®Šæˆ 1000ã€‚",
                correct: "x Ã— 2 = 1000",
                options: ["x Ã— 2 = 1000", "x + 2 = 1000", "x Ã· 2 = 1000", "x + x = 2000"]
            },
            {
                text: "æº«åº¦ç¾åœ¨æ˜¯ x åº¦ï¼Œä¸‹é™ 20 åº¦å¾Œï¼Œè®Šæˆ 10 åº¦ã€‚",
                correct: "x - 20 = 10",
                options: ["x - 20 = 10", "20 - x = 10", "x + 20 = 10", "x Ã· 20 = 10"]
            }
        ];

        let currentQ = 0;
        let score = 0;
        let isAnswering = false;
        const alienEmojis = ["ğŸ‘½", "ğŸ‘¾", "ğŸ¤–", "ğŸ™", "ğŸ’€"];

        function startGame() {
            initAudio();
            document.getElementById('start-screen').style.display = 'none';
            score = 0;
            currentQ = 0;
            updateScore();
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQ >= questions.length) {
                endGame();
                return;
            }

            const q = questions[currentQ];
            // æ›´æ–°å¤–æ˜Ÿäºº
            const alien = document.getElementById('alien-avatar');
            alien.innerText = alienEmojis[Math.floor(Math.random() * alienEmojis.length)];
            
            // æ›´æ–°æ–‡å­—
            document.getElementById('order-text').innerText = q.text;

            // ç”Ÿæˆé¸é …
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            // éš¨æ©Ÿæ’åºé¸é …
            let shuffledOpts = [...q.options].sort(() => Math.random() - 0.5);

            shuffledOpts.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'btn-recipe';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(opt, q.correct, btn);
                container.appendChild(btn);
            });

            isAnswering = true;
        }

        function checkAnswer(selected, correct, btn) {
            if (!isAnswering) return;
            isAnswering = false;

            const feedback = document.getElementById('feedback');

            if (selected === correct) {
                score += 100;
                playSizzle();
                btn.style.borderColor = 'var(--neon-green)';
                btn.style.color = 'var(--neon-green)';
                btn.style.background = 'rgba(0, 255, 65, 0.2)';
                feedback.innerText = "ğŸ” ç¾å‘³!";
                feedback.style.textShadow = "0 0 20px var(--neon-green)";
            } else {
                playAlienGrunt();
                btn.style.borderColor = 'red';
                btn.style.color = 'red';
                feedback.innerText = "ğŸ¤¢ é›£åƒ!";
                feedback.style.textShadow = "0 0 20px red";
            }

            feedback.style.opacity = 1;
            updateScore();

            setTimeout(() => {
                feedback.style.opacity = 0;
                currentQ++;
                document.getElementById('level').innerText = currentQ + 1;
                loadQuestion();
            }, 1200);
        }

        function updateScore() {
            document.getElementById('score').innerText = score;
        }

        function endGame() {
            clearInterval(bgmInterval);
            document.getElementById('end-screen').style.display = 'flex';
            document.getElementById('final-score').innerText = `ç¸½ç‡Ÿæ”¶: $${score}`;
        }
    </script>
</body>
</html>